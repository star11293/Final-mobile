<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Light Blue Calendar</title>
  <style>
    body {
      background: linear-gradient(135deg, #e3f2fd 0%, #bbdefb 100%);
      font-family: 'Segoe UI', sans-serif;
      margin: 0;
      padding: 0;
    }
    .calendar-container {
      max-width: 800px;
      margin: 40px auto;
      background: #f8fcff;
      box-shadow: 0 8px 32px rgba(33,150,243,0.18);
      border-radius: 30px;
      padding: 40px 30px;
      animation: popin 1s cubic-bezier(.68,-0.55,.27,1.55);
    }
    @keyframes popin {
      0% { transform: scale(0.7); opacity: 0; }
      100% { transform: scale(1); opacity: 1; }
    }
    .calendar-header {
      text-align: center;
      font-size: 2.4em;
      font-weight: bold;
      color: #1976d2;
      margin-bottom: 10px;
      letter-spacing: 2px;
      text-shadow: 1px 1px 10px #e1f5fe;
    }
    .calendar {
      display: grid;
      grid-template-columns: repeat(7, 1fr);
      gap: 8px;
      font-size: 1.2em;
      margin: 0 auto;
    }
    .calendar-day,
    .calendar-date {
      text-align: center;
      padding: 13px 0;
      border-radius: 12px;
      font-weight: 600;
      transition: background 0.2s, color 0.2s, transform 0.2s;
      user-select: none;
    }
    .calendar-day {
      background: #b3e5fc;
      color: #0277bd;
      font-weight: bold;
      letter-spacing: 1px;
      font-size: 1.1em;
    }
    .calendar-date {
      background: #e1f5fe;
      color: #0288d1;
      box-shadow: 0 2px 8px rgba(33,150,243,0.08);
    }
    .calendar-date.available {
      background: linear-gradient(135deg, #64b5f6 0%, #bbdefb 100%);
      color: #fff;
      cursor: pointer;
      animation: pulse 1.5s infinite;
    }
    @keyframes pulse {
      0% { box-shadow: 0 0 0 0 rgba(33,150,243,0.2); }
      70% { box-shadow: 0 0 0 16px rgba(33,150,243,0); }
      100% { box-shadow: 0 0 0 0 rgba(33,150,243,0); }
    }
    .calendar-date.available:hover {
      background: linear-gradient(135deg, #2196f3 0%, #90caf9 100%);
      color: #ffffff;
      transform: scale(1.13) rotate(-3deg);
      box-shadow: 0 4px 24px rgba(33,150,243,0.35);
    }
    .calendar-date.today {
      border: 3px solid #1976d2;
      background: #f3f9ff;
      color: #1976d2;
    }
    a {
      text-decoration: none;
      color: inherit;
      display: block;
      width: 100%;
      height: 100%;
    }
    /* Existing media query for tablets and small screens */
    @media (max-width: 700px) {
      .calendar-container {
        padding: 15px 3px;
      }
      .calendar-header {
        font-size: 1.4em;
      }
      .calendar {
        font-size: 1em;
      }
    }
    /* Extra mobile responsiveness for very small screens */
    @media (max-width: 480px) {
      .calendar-container {
        margin: 10px 2px;
        padding: 8px 2px;
        border-radius: 16px;
      }
      .calendar-header {
        font-size: 1.1em;
        margin-bottom: 8px;
      }
      .calendar {
        font-size: 0.9em;
        gap: 4px;
      }
      .calendar-day,
      .calendar-date {
        padding: 8px 0;
        font-size: 0.95em;
      }
    }
  </style>
</head>
<body>
  <div class="calendar-container">
    <div class="calendar-header">
      <button id="prev-month" aria-label="Previous month">&#8592;</button>
      <span id="month-year-label">Available Dates</span>
      <button id="next-month" aria-label="Next month">&#8594;</button>
    </div>
    <div class="calendar" id="calendar"></div>
  </div>

  <!-- Registration Form Section -->
  <div class="registration-container" id="registration-container">
    <h2 class="registration-header">Register for a Date & Time</h2>
    <div class="registration-subheader" id="course-label" aria-live="polite"></div>

    <form class="registration-form" id="registration-form" novalidate>
      <label for="reg-date">Date:</label>
      <input type="text" id="reg-date" name="date" readonly />
      <input type="hidden" id="reg-course" name="course" />

      <label for="reg-time">Time:</label>
      <input type="text" id="reg-time" name="time" value="4:00pm - 8:00pm" readonly />

      <label for="reg-name">Your Name:</label>
      <input type="text" id="reg-name" name="name" required placeholder="Enter your name" />

      <label for="reg-email">Email:</label>
      <input type="email" id="reg-email" name="email" required placeholder="Enter your email" />

      <label for="phone">Phone Number:</label>
      <input type="tel" id="phone" name="phone" placeholder="123-456-7890" required />

      <button type="submit">Register</button>
      <div class="success-message" id="success-message">Registration submitted!</div>
    </form>

    <!-- Payment Section (hidden until submit) -->
    <div class="payment-section" id="payment-section">
      <div class="payment-title" id="payment-title">Complete Your Payment</div>
      <div class="paypal-btns" id="paypal-buttons">
        <!-- BLS -->
        <div id="paypal-bls" style="display:none;">
          <a href="https://www.paypal.com/ncp/payment/5MRNC99WPY3TC" target="_blank" rel="noopener">
            <img src="https://www.paypalobjects.com/webstatic/en_US/i/buttons/checkout-logo-large.png" alt="Pay with PayPal for BLS" />
          </a>
          <div class="note">BLS Certification Payment</div>
        </div>
        <!-- ACLS -->
        <div id="paypal-acls" style="display:none;">
          <a href="https://www.paypal.com/ncp/payment/7BZ6TVTY3T29A" target="_blank" rel="noopener">
            <img src="https://www.paypalobjects.com/webstatic/en_US/i/buttons/checkout-logo-large.png" alt="Pay with PayPal for ACLS" />
          </a>
          <div class="note">ACLS Certification Payment</div>
        </div>
        <!-- PALS -->
        <div id="paypal-pals" style="display:none;">
          <a href="https://www.paypal.com/ncp/payment/SNS9PHURF28Q4" target="_blank" rel="noopener">
            <img src="https://www.paypalobjects.com/webstatic/en_US/i/buttons/checkout-logo-large.png" alt="Pay with PayPal for PALS" />
          </a>
          <div class="note">PALS Certification Payment</div>
        </div>
        <!-- Bloodborne Pathogens -->
        <div id="paypal-blood" style="display:none;">
          <a href="https://www.paypal.com/ncp/payment/6JG97D336NFJU" target="_blank" rel="noopener">
            <img src="https://www.paypalobjects.com/webstatic/en_US/i/buttons/checkout-logo-large.png" alt="Pay with PayPal for Bloodborne Pathogens" />
          </a>
          <div class="note">Bloodborne Pathogens Payment</div>
        </div>

        <!-- Fallback: show all if course is unknown -->
        <div id="paypal-all" style="display:none;">
          <div class="note">Course not detected â€” choose your payment link:</div>
          <div style="margin-top:8px;">
            <div style="margin:6px 0;">
              <a href="https://www.paypal.com/ncp/payment/5MRNC99WPY3TC" target="_blank" rel="noopener">Pay for BLS</a>
            </div>
            <div style="margin:6px 0;">
              <a href="https://www.paypal.com/ncp/payment/7BZ6TVTY3T29A" target="_blank" rel="noopener">Pay for ACLS</a>
            </div>
            <div style="margin:6px 0;">
              <a href="https://www.paypal.com/ncp/payment/SNS9PHURF28Q4" target="_blank" rel="noopener">Pay for PALS</a>
            </div>
            <div style="margin:6px 0;">
              <a href="https://www.paypal.com/ncp/payment/6JG97D336NFJU" target="_blank" rel="noopener">Pay for Bloodborne Pathogens</a>
            </div>
          </div>
        </div>
      </div>
      <div class="note">After payment, you'll receive confirmation via email.</div>
    </div>
  </div>

  <script>
    // Utilities
    function pad2(n) { return String(n).padStart(2, '0'); }
    function getQueryParam(param) {
      const urlParams = new URLSearchParams(window.location.search);
      return urlParams.get(param);
    }

    // Course mapping
    const COURSE_TITLES = {
      BLS: 'BLS Certification & Renewal',
      ACLS: 'ACLS Certification & Renewal',
      PALS: 'PALS Certification & Renewal',
      BLOOD: 'Bloodborne Pathogens Course'
    };

    // Calendar state
    let today = new Date();
    let year = today.getFullYear();
    let month = today.getMonth(); // 0-indexed

    const daysOfWeek = ["Sun", "Mon", "Tue", "Wed", "Thu", "Fri", "Sat"];
    const calendar = document.getElementById('calendar');
    const calendarHeaderLabel = document.getElementById('month-year-label');

    // Render header label
    function updateHeader() {
      const displayMonth = new Date(year, month).toLocaleString('default', { month: 'long', year: 'numeric' });
      calendarHeaderLabel.innerText = `Available Dates - ${displayMonth}`;
    }

    // Build the calendar for the current month and year
    function buildCalendar() {
      // Clear previous calendar days
      calendar.innerHTML = '';

      // Day headers
      daysOfWeek.forEach(day => {
        const div = document.createElement('div');
        div.className = 'calendar-day';
        div.innerText = day;
        calendar.appendChild(div);
      });

      const daysInMonth = new Date(year, month + 1, 0).getDate();
      const availableDates = [];

      // Mondays (1) and Thursdays (4)
      for (let d = 1; d <= daysInMonth; d++) {
        const dayOfWeek = new Date(year, month, d).getDay();
        if (dayOfWeek === 1 || dayOfWeek === 4) {
          availableDates.push(d);
        }
      }

      // Offset blanks before day 1
      const firstDay = new Date(year, month, 1).getDay();
      for (let i = 0; i < firstDay; i++) {
        const div = document.createElement('div');
        div.className = 'calendar-date';
        calendar.appendChild(div);
      }

      // Fill dates
      for (let d = 1; d <= daysInMonth; d++) {
        const div = document.createElement('div');
        div.className = 'calendar-date';

        // Today style
        if (year === today.getFullYear() && month === today.getMonth() && d === today.getDate()) {
          div.classList.add('today');
        }

        if (availableDates.includes(d)) {
          div.classList.add('available');
          const a = document.createElement('a');
          a.href = "#registration-container";
          a.innerText = d;
          a.addEventListener('click', function(e) {
            e.preventDefault();
            const dateString = `${year}-${pad2(month+1)}-${pad2(d)}`;
            openRegistration(dateString);
          });
          div.appendChild(a);
        } else {
          div.innerText = d;
        }

        calendar.appendChild(div);
      }
    }

    function openRegistration(dateString) {
      const container = document.getElementById('registration-container');
      const dateInput = document.getElementById('reg-date');
      dateInput.value = dateString;
      container.style.display = 'block';
      setTimeout(() => {
        container.scrollIntoView({ behavior: 'smooth', block: 'start' });
      }, 80);
    }

    // Prev/Next navigation
    document.getElementById('prev-month').addEventListener('click', () => {
      month -= 1;
      if (month < 0) { month = 11; year -= 1; }
      updateHeader(); buildCalendar();
    });
    document.getElementById('next-month').addEventListener('click', () => {
      month += 1;
      if (month > 11) { month = 0; year += 1; }
      updateHeader(); buildCalendar();
    });

    // On load: set course label/hidden input if provided
    document.addEventListener('DOMContentLoaded', () => {
      const courseParamRaw = getQueryParam('course');
      const courseParam = courseParamRaw ? courseParamRaw.toUpperCase() : '';
      const courseInput = document.getElementById('reg-course');
      const courseLabel = document.getElementById('course-label');

      if (courseParam) {
        courseInput.value = courseParam;
        const title = COURSE_TITLES[courseParam] || courseParam;
        courseLabel.textContent = `Selected Course: ${title}`;
      } else {
        courseLabel.textContent = 'No course selected yet';
      }

      updateHeader();
      buildCalendar();
    });

    // Registration submit -> show PayPal button
    document.getElementById('registration-form').addEventListener('submit', function(e) {
      e.preventDefault();

      // Minimal client validation
      const name = document.getElementById('reg-name').value.trim();
      const email = document.getElementById('reg-email').value.trim();
      const phone = document.getElementById('phone').value.trim();
      if (!name || !email || !phone) {
        alert('Please fill in name, email, and phone.');
        return;
      }

      // Show success briefly, then show payment section
      const success = document.getElementById('success-message');
      success.style.display = 'block';

      setTimeout(() => {
        success.style.display = 'none';
        // Hide the form, show payment
        document.getElementById('registration-form').style.display = 'none';
        showPaymentButtons();
      }, 800);
    });

    function showPaymentButtons() {
      // Hide all first
      ['paypal-bls','paypal-acls','paypal-pals','paypal-blood','paypal-all'].forEach(id => {
        const el = document.getElementById(id);
        if (el) el.style.display = 'none';
      });

      const paymentSection = document.getElementById('payment-section');
      const paymentTitle = document.getElementById('payment-title');
      const course = (document.getElementById('reg-course').value || '').toUpperCase();

      // Update title with course
      const title = COURSE_TITLES[course];
      paymentTitle.textContent = title ? `Complete Your Payment - ${title}` : 'Complete Your Payment';

      // Show relevant button or fallback
      if (course === 'BLS') document.getElementById('paypal-bls').style.display = 'block';
      else if (course === 'ACLS') document.getElementById('paypal-acls').style.display = 'block';
      else if (course === 'PALS') document.getElementById('paypal-pals').style.display = 'block';
      else if (course === 'BLOOD') document.getElementById('paypal-blood').style.display = 'block';
      else document.getElementById('paypal-all').style.display = 'block';

      paymentSection.style.display = 'block';
      paymentSection.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }

    // OPTIONAL: If you prefer auto-redirect to PayPal instead of showing a button,
    // uncomment below and call redirectToPayPal(course) instead of showPaymentButtons() above.
    /*
    const PAYPAL_LINKS = {
      BLS: 'https://www.paypal.com/ncp/payment/5MRNC99WPY3TC',
      ACLS: 'https://www.paypal.com/ncp/payment/7BZ6TVTY3T29A',
      PALS: 'https://www.paypal.com/ncp/payment/SNS9PHURF28Q4',
      BLOOD: 'https://www.paypal.com/ncp/payment/6JG97D336NFJU'
    };
    function redirectToPayPal(course) {
      const url = PAYPAL_LINKS[(course||'').toUpperCase()];
      if (url) window.location.href = url;
      else alert('Unknown course; please choose the correct payment link.');
    }
    */
  </script>
</body>
</html>
